<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="David" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Updating TSS2000.MDB with Shapefiles</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">TSS-Update: Updating TSS2000.MDB with shapefiles</text></para>
    </header>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><image src="TSS-Update.png" scale="100.00%" styleclass="Image Caption"></image></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Program </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS-Update</text><text styleclass="Normal" translate="true"> completes the round-tripping process by reading a WallsMap shapefile and updating the TSSTEX table in TSS2000.MDB with its content. Although it&apos;s not a requirement, the shapefile will normally have the same attribute structure as one </text><text styleclass="Normal" style="font-style:italic;" translate="true">exported</text><text styleclass="Normal" translate="true"> from TSSTEX using the template named </text><text styleclass="Normal" style="font-style:italic;" translate="true">All_Data-TSS.shpdef</text><text styleclass="Normal" translate="true">. The corresponding template that </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS-Update</text><text styleclass="Normal" translate="true"> reads, telling it what fields to copy, has a similar format and is named </text><text styleclass="Normal" style="font-style:italic;" translate="true">All_Data-TSS.tsstmp</text><text styleclass="Normal" translate="true">. The original idea was that a different shapefile structure might require preparation of a custom template, but it turns out that a better approach in</text><text styleclass="Normal" style="font-style:normal;" translate="true"> this uncommon situation is to use the more flexible export functions of WallsMap (which also supports templates) to create a new shapefile with the standard structure. </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS-Update</text><text styleclass="Normal" style="font-style:normal;" translate="true"> can then be run using the default template,</text><text styleclass="Normal" style="font-style:italic;" translate="true"> All_Data-TSS.tsstmp</text><text styleclass="Normal" translate="true">. If it hasn&apos;t already been done, the shapefile can also be filtered in the process to contain only records that have changed since the last update. Simply open a table view in WallsMap, sort on the Updated timestamp column, and export an appropriate subset of rows. This filtering is especially helpful when the database has in the meantime undergone some sort of global update or restructuring, such as a TexBio update.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The recommended practice is to first run </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS-Update</text><text styleclass="Normal" translate="true"> with option &quot;Update table TSSTEX&quot; unchecked. Processing will then occur with no changes actually being made to the database. Instead, at the end of the run, a log file will automatically be displayed in your text editor informing you of what changes </text><text styleclass="Normal" style="font-style:italic;" translate="true">would </text><text styleclass="Normal" style="font-style:normal;" translate="true">have </text><text styleclass="Normal" translate="true">been made had you checked that option. The final run, where updates are committed to TSS2000.mdb, will produce a similar log file that can be passed on to the person who submitted the update.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">At this point </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS-Export</text><text styleclass="Normal" translate="true"> can be used to generate new shapefiles for the </text><text styleclass="Normal" style="font-style:italic;" translate="true">TSS_Data</text><text styleclass="Normal" translate="true"> project. If the changes are anything but trivial, the website copy of the project is updated.</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
