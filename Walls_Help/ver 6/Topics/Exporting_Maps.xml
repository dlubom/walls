<?xml version="1.0" encoding="UTF-8"?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Exporting Maps as Metafiles</title>
  <keywords>
    <keyword translate="true">Exporting Maps as Metafiles</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Exporting Maps as Metafiles</text></para>
    </header>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><image src="mapexport.png" scale="100.00%" style="font-family:&apos;MS Sans Serif&apos;; font-size:8pt; color:#000000;"></image></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Walls supports the creation of two basic types of vector-based image files: metafiles (extensions </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">WMF and EMF</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">) and Scalable Vector Graphics files (extension </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SVG</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">). The export dialogs are accessible via the File menu (File | Export map as ...) whenever a compiled project item is being reviewed. That is, whenever you are able to print (or print preview) a map, you can instead choose to export that same map as a metafile or SVG. Note that what we are really exporting is a 2D </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">drawing</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> in the form of editable text and path objects. Only with a </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Export_3D" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">VRML export</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> do we save the survey as a 3D object.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">While SVG is a new format with limited application support (see </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SVG_Import_and_Export" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Roundtripping SVG Maps</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">), most Windows-based illustration programs, such as CorelDraw and</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">&#32;</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Adobe Illustrator, can correctly import the WMF files produced by Walls. So can image conversion utilities that attempt to convert any one format to a variety of other formats, such as DXF, CGM, CDX, CDR, and EPS. Only a few of these programs even attempt to read the theoretically more versatile &quot;enhanced metafiles&quot; (extension EMF), the basic problem being that the EMF format tries to encompass the entire Graphics Device Interface (GDI) of the Windows operating system (Win32). Applications have a hard enough time handling, in a uniform way, the much simpler 16-bit WMF format.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Actually, two varieties of WMF exist: the official, Microsoft-sanctioned WMF, which is almost useless for image interchange, and the WMF that most programs expect and which Walls produces. The latter variety has an &quot;Aldus placeable header&quot; which relays to the importing program the image&apos;s resolution and true rectangle dimensions. (Microsoft&apos;s solution to WMF deficiencies, of course, is EMF.)</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">You&apos;ll notice that Walls maintains a separate set of format options (see </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Map_Format_Options" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Map Options Dialog</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">) for exported maps. &#160;One reason for this is that many otherwise excellent drawing programs have less than perfect import routines (or filters). Ideally, printed output from Walls and the drawing program should closely match when map options for printer and export are identical. &#160;Xara X, for example, fails to meet this criterion in a number of typical ways. &#160;While not supporting EMF at all, it reduces by one third the point size of all imported text in a WMF. It also uses the character cell&apos;s lower left corner instead of its upper left corner for positioning text, possibly causing labels to overrun the top edge of the frame. &#160;(If this happens, the image&apos;s vertical dimension is rescaled without warning!) &#160;You can often cancel the effects of these kinds of quirks by adjusting various settings in Walls. For example, if you were targeting Xara X and wanted 8-point text for labels, you would select a 12-point label font for exported maps. Also, to force Xara X to correctly position the text, you would change the y-offset for labels from 0, its usual value, to 8, the resulting text height.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Due to integer overflow problems, Illustrator 8 produces garbage when importing large WMF documents, such as ones with 50-inch wide frames. (Thanks to Bob Osburn for catching this.) Evidently, this has been fixed beginning with Illustrator 9.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Other problems might require you to forego the use of some features. I found that some programs have difficulty with dashed or dotted line styles. Xara X, without explanation, simply refuses to import the file. Errors in scaling are also surprisingly common. Hijaak Pro v4 brings in the entire WMF image at only half its correct size. &#160;It&apos;s a nuisance to have to resize an image (or its contained objects) after an import, but a decent result should still obtainable after a little tweaking. The fact that rescaling causes no loss of quality is one of the main advantages of a metafile import as opposed to a bitmap image import.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Another format option you should be aware of is station label spacing -- see </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Map_Format_Options" anchor="Labels_and_Notes" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Labels and Notes</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">. While it&apos;s possible to specify a large frame (say 5 feet wide) and a tiny font, so that label overlap is unlikely, you might still want to avoid labeling every station. &#160;Otherwise, the large number of text objects could exceed the capacity of the importing program. &#160;(This might depend on how much memory your computer has.) The solution, in this case, is to not use overlap avoidance, or proximity, as the </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">only</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> criterion for labeling stations (Gap&gt;0, Inc=1), but to use a sequencing criterion as well -- perhaps even exclusively. For example, Gap=0 and Inc=5 would cause every 5th station in the traverse-oriented plotting sequence to be unconditionally labeled. &#160;If necessary, overlapping labels can be repositioned or deleted in the target program.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Once you import a metafile into a drawing program, perhaps as a &quot;layer&quot; in an existing document, you may want to &quot;ungroup&quot; the resulting objects. This way, the frame, grid, vectors, markers, flags, labels, and notes can be individually edited or repositioned. (That&apos;s another big advantage of a metafile import.) &#160;A common requirement is to place different classes of objects into different layers -- for example, labels and markers into layer #1, and notes, flags, and lines into layer #2. &#160;Depending on the drawing program, the easiest way to do this may be to have Walls create separate metafiles for import into specific layers of the same document.</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"></para>
  </body>
</topic>
