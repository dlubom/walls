<topic template="Default" lasteditedby="David" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Statistical Formulas</title>
  <keywords>
    <keyword translate="true">F-ratios</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Statistical Formulas</text></para>
    </header>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left,204px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Here is a more detailed description of the numbers displayed in Walls dialogs -- namely the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="UVE" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">UVEs</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> that rank loop systems, the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="F_statistic" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">F-ratios</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> that rank traverses, and the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="best_correction" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">best corrections</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> that identify data errors. &#160;This is an attempt to state exactly what&apos;s being computed by the program, not to explain fully the theory and derivations. &#160;Information on the statistical terms and distributions can be looked up in appropriate textbooks. &#160;How the numbers are used during data screening is discussed in </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Geometry_page" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Geometry Page</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Traverse_page" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Traverse Page</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">, and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Screening_Overview" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Data Screening Tutorial</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">. </text></para>
    <para style="tabstops:168px left,204px left ;"></para>
    <para style="tabstops:168px left,204px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">We start by letting </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">X , Y, </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">and </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Z</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> represent the components of a measured traverse, with </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Vh</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> and </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Vz</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> representing their assigned error </text><link displaytype="text" defaultstyle="true" type="topiclink" href="variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">variances.</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> &#160;The modifier </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">h</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> is used to indicate that the horizontal components (X and Y) are being given identical assignments. &#160;Also, we&apos;ll assume that the traverse in question is not constrained: Vh &gt; 0 and Vz &gt; 0. &#160;(For a description of how Walls computes a traverse&apos;s error variance see </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Variance_Assignments" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Variance Assignments.</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">)</text></para>
    <para style="tabstops:168px left,204px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">First, we perform a </text><link displaytype="text" defaultstyle="true" type="topiclink" href="least_squares" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">least-squares</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> adjustment of a loop system, thereby obtaining for each traverse the final estimated displacement: </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">x, y, z,</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> and the theoretical </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">variances</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> of this estimate: </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">vh</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> and </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">vz </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">(the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="network_variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">network variances</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">). &#160;Also provided by the adjustment routine are the loop counts, </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Nh</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> and </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Nz, </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">and the quantities actually minimized, the sums of squares of </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">weighted residuals</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">:</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SSh = </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Sum over all unconstrained traverses of</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true"> ((X - x)² + (Y - y)²) / Vh, </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">and</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SSz = </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Sum over all unconstrained traverses of</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true"> (Z - z)² / Vz,</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">The </text><link displaytype="text" defaultstyle="true" type="topiclink" href="UVE" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">unit variance estimates</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> are then</text></para>
    <para style="tabstops:168px left ;"></para>
    <para styleclass="Normal"><text styleclass="Normal" style="font-weight:bold;" translate="true">UVEh = SSh / (2</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true"> · </text><text styleclass="Normal" style="font-weight:bold;" translate="true">Nh)</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> &#160;and &#160;</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">UVEz = SSz / Nz.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">If we assume that a traverse&apos;s error components actually have the assigned variances, and that they are also independent, normally distributed random variables with zero means, then SSh and SSz have </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">chi-square distributions</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> with 2·Nh and Nz degrees of freedom. &#160;UVEh and UVEz would then have unit means and variances 1 / Nh and 2 / Nz, respectively. &#160;Anything tending to invalidate these assumptions, such as gross data errors, would presumably inflate the UVEs to values larger than one, the significance of a given increase depending on the loop count.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">The approach taken in Walls is less strict than this since we&apos;re mainly interested in measuring consistency. &#160;If, for the sake of computing useful numbers, we assume only that the assigned variances are correct apart from an unknown scaling factor (i.e., the </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">unit variance</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">), the UVE can be interpreted as a </text><link displaytype="text" defaultstyle="true" type="topiclink" href="sample_variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">sample variance</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> that estimates this scaling factor. &#160;Its expected value after data screening could be significantly different from one depending on the survey&apos;s quality (grade), skill of surveyors, and difficulty.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Whereas the UVEs gauge overall consistency of survey data with respect to an assumed model, the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="F_statistic" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">F-ratios</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> measure </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">relative</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> consistency. &#160;We might ask if a particular observation&apos;s contribution to the sum of squares is unusually large when measured against the consistency of the remaining data. &#160;It can be shown that if a traverse is deleted from the data set, the sums of squares will decrease by</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SEh = ((X - x)² + (Y - y)²) / (Vh - vh)</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> &#160;and &#160;</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SEz = (Z - z)² / (Vz - vz).</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">&#32;</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Now let&apos;s simplify our notation by dropping the modifiers (h and z) and using variable </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">M</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> to denote the number of dimensions under consideration: two for the horizontal case and one for the vertical case. &#160;The traverse&apos;s two F-ratios are then computed as</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">F = (SE / M) / ((SS - SE) / (M·(N - 1))).</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Note that the denominator of F is the new system UVE resulting from the traverse&apos;s deletion. &#160;While the formula for F depends on the </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">relative</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> sizes of variances assigned to traverses, it&apos;s clear that the variance scaling factor cancels out. &#160;Although M also cancels out of this expression, we leave it in to illustrate that the numerator and denominator of F (under the assumptions mentioned above for SS) are independent chi-square statistics scaled to have unit means. &#160;F, like a loop system&apos;s UVE, is a nonnegative number, possibly very large. &#160;If it is greater than one, the traverse&apos;s presence in the data is hurting consistency (making the system UVE larger). &#160;If it is less than one, consistency is being helped. </text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Finally, the traverse&apos;s </text><link displaytype="text" defaultstyle="true" type="topiclink" href="best_correction" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">best correction</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> is</text></para>
    <para style="tabstops:24px left ;"></para>
    <para style="tabstops:24px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Cz = - (Z - z) · Vz / (Vz - vz),</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> &#160;with </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Cx </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">and </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">Cy</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> obtained similarly.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Thus the key results we need for data screening depend on our adjustment algorithm having provided the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="network_variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">network variances</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">, vh and vz. &#160;I&apos;ll omit the derivation of these formulas; if they were incorrect the Walls review dialogs (e.g., float operations) wouldn&apos;t work at all. &#160;</text></para>
    <para style="tabstops:168px left ;"></para>
    <para styleclass="Normal"><text styleclass="Subheader" translate="true">Some Notes on Interpretation</text></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">The F-ratios displayed by Walls are so named because of their presumed behavior under ideal circumstances. &#160;If there were no blunders, and if our simple statistical model (including the normality assumption) was realistic, the F-ratio computed for a traverse in a system with loop count N would have a </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">central F-distribution</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> with M and M·(N - 1) degrees of freedom. &#160;You can find information on this distribution in most introductory statistics texts. &#160;It&apos;s worth noting that the expected value of F is N / (N - 2) for N &gt; 2, or about one for systems with large loop counts.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">One approach to understanding what would happen to F if we were to introduce a blunder -- say a fixed vector E added to the random traverse measurement -- is to consider its behavior as a random variable with a </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">non-central F-distribution.</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> &#160;A much simpler approach is to realize that perturbing the traverse by vector E, simply adds -E to the traverse&apos;s best correction. &#160;You&apos;ll notice that while the denominator in the above expression for F (the UVE after deletion) doesn&apos;t change, the numerator SE / M certainly does and usually does so dramatically. &#160;In fact, we can express SE in terms of the best correction&apos;s squared length (C² = Cx² + Cy² when M = 2, or C² = Cz² when M = 1):</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">SE = C² /</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">&#32;</text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">(V + vº),</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">where </text><text style="font-family:Arial; font-size:9pt; font-weight:bold; color:#000000;" translate="true">vº = v·V / (V - v)</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> is the corresponding </text><link displaytype="text" defaultstyle="true" type="topiclink" href="network_variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">network variance</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> with the traverse discarded. &#160;If we assume that the best correction without the blunder is of negligible size -- its expected squared length theoretically being M·(V + vº) -- then it&apos;s obvious that </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">a blunder will inflate the F-ratio at a rate proportional to the blunder&apos;s squared length. </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> It&apos;s also clear that for a blunder of fixed size, F will on average be larger when the quantity V + vº is smaller. &#160;A small vº indicates that the remaining network, by virtue of its geometry and the variances assigned to it, can in principle provide a good estimate of the true displacement. &#160;Finally, in the case where both blunder and assigned variances are fixed, F will be larger when the consistency actually achieved by the remaining network is better -- that is, when F&apos;s denominator, the UVE after detachment, is smaller.</text></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">&#32;</text></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">While these theoretical observations suggest </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">why</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> the F-ratios are effective, there is certainly no critical dependence in Walls on the assumptions made about variances and distributions, which, of course, are never strictly valid anyway. &#160;All that really matters is that if a traverse is affected by one or more blunders, its horizontal and/or vertical F-ratio is likely to be </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">much</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> larger than those of traverses not so affected. &#160;By experimenting with the program you should have no trouble verifying this.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para style="tabstops:168px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">F-ratios have been recognized for their ability to flag outliers in measurement data; however, they aren&apos;t as popular as other methods because they&apos;re relatively hard to compute. &#160;In our case, obtaining the necessary </text><link displaytype="text" defaultstyle="true" type="topiclink" href="network_variance" style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">network variances</link><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> requires the partial </text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">inversion</text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true"> of a very large matrix -- more than what&apos;s required by a least-squares adjustment alone. &#160;Therefore, for simply ranking traverses, why don&apos;t we consider something more familiar -- like &quot;error ratios&quot;, which are just the weighted least-squares residuals? &#160;The main reason we don&apos;t is that statistics based on residuals are much weaker than F-ratios because they tend to be highly correlated. &#160;In a large network, for example, a severe blunder could easily make the good traverses nearby look worse than bad traverses some distance away. &#160;The F-ratios, while still correlated in a strict sense, are so specific in their sensitivity that we&apos;ve had no trouble identifying multiple blunders after a single data compilation. &#160;Besides that, the F-ratios are conceptually akin to UVEs and come hand-in-hand with the best corrections.</text></para>
    <para style="tabstops:168px left ;"></para>
    <para styleclass="Normal"><text styleclass="Subheader" translate="true">Special Cases</text></para>
    <para style="tabstops:168px left,204px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">There are two special cases that I will mention only briefly. &#160;First, if the traverse is constrained, then V = v = 0, and trying to retrieve the statistics in the above manner would be rather futile. &#160;The Walls adjustment module simply wasn&apos;t designed to provide the information we need in this case, even though the statistics are in fact definable in terms of the unknown quantity vº &gt; 0. &#160;Hence, &quot;&lt;FIXED&gt;&quot; is displayed in place of the statistics in Walls dialogs. &#160;To obtain just the best correction, the user can temporarily float the traverse. &#160;To obtain F as well, the user can assign an insignificant but positive variance to the traverse instead of strictly constraining it.</text></para>
    <para style="tabstops:168px left,204px left ;"></para>
    <para style="tabstops:168px left,204px left ;"><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">Second, when we are dealing with an isolated loop, the system&apos;s loop count is actually N = 1, again making the above formulas inapplicable. &#160;So that a legitimate F-ratio can still be derived, the entire set of isolated loops belonging to a connected component is treated in Walls as if it were a single loop system. &#160;The denominator in F is therefore the combined UVE for a</text><text style="font-family:Arial; font-size:9pt; font-style:italic; color:#000000;" translate="true">ll other </text><text style="font-family:Arial; font-size:9pt; color:#000000;" translate="true">isolated loops. &#160;If there are no others, then Walls simply displays the traverse&apos;s UVE (e.g., UVEz = Z² / Vz) in place of F.</text></para>
    <para style="tabstops:168px left,204px left ;"></para>
  </body>
</topic>
